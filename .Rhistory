#setwd("C:/Users/lscpuser/Google Drive/R/")
#data <- read.table(file="C:/Users/lscpuser/Google Drive/R/DataTable RAW.txt", header=T)
#source("C:/Users/lscpuser/Google Drive/R/R_Lib_Sackur.r")
setwd("C:/Users/subcomarc/Google Drive/R/")
#data <- read.table(file="C:/Users/subcomarc/Google Drive/R/DataTable RAW.txt", header=T)
source("C:/Users/subcomarc/Google Drive/R/R_Lib_Sackur.r")
library('xtable')
library('knitr')
library('lme4')
library('car')
library('multcomp')
library('lsmeans')
library("Hmisc")
library("HH")
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
##################################################################
#Load preprocessed data (for preprocessing see analysesTUNNEL2.r)#
##################################################################
load("TunnelData.r")
###################### ###################### ######################
#STATISTICAL ANALYSES#
###################### ###################### ######################
#Prepping the data for stats and adding some convenient columns
data<-data
#data$HarSc[data$suj==1121]<-10 #Correct one wrong hypnotizability raw score
data$NewRaw<-data$HarSc
#data<-droplevels(data[!data$suj %in% c(1091,1101,1121,2111),])#Eliminate subs with dubious hypno reactions during test (beware of ,2111)
#data<-droplevels(data[!data$suj %in% c(1091,1101,2111),])#Eliminate subs with dubious hypno reactions during test (beware of ,2111)
#data$HarSc[data$suj==1091]<-9
#data$HarSc[data$suj==1101]<-9
data$rep <- 1 #for repetition priming
data$rep[data$Target!=data$Prime] <- 0
data$perf <- data$rt #for having rt for all blocks on the same column
data$perf[data$block==2] <- data$rtVis[data$block==2]
data$RTimeVis<-round(data$RTimeVis*1000)
data$RTimeVis[data$block %in% c(1,3)]<-5000
data <- droplevels(data[data$RTimeVis<5001,])
data<- droplevels(data[!(data$block!=2 & data$rt>3500),])
#data<- droplevels(data[!(data$block!=2 & data$rt>1500),])
#data<- droplevels(data[!(data$block!=2 & data$rt<200),])
data$IsSeen<-1 #for treating visibility as a binary
data$IsSeen[data$Visibility<2]<-0 #for treating visibility as a binary
data$suj<-as.numeric(as.character(data$suj))
data$NewH<-2 #Medium
data$NewH[data$HarSc>7]<-3 #High
data$NewH[data$HarSc<4]<-1 #Low
data$Induction<-1
data$Induction[data$hyp==3]<-0
data$NewH[data$suj %in% c(1091,1101,1121)]<-3
data$NewH[data$suj %in% c(2111)]<-1
#data<-droplevels(data[!(data$hyp==3 & data$HarSc<4),])#for a control group with only mediums
#data<-droplevels(data[!(data$hyp==3 & data$HarSc>8),])#for a control group with only mediums
data2 <- data[data$dur>0 & data$PrimeNoPrime==1 & data$IsPrimed!=2,] #to have a dataset without the trials without prime
data$block <- factor(data$block)
data$suj <- factor(data$suj)
data$hyp <- factor(data$hyp)
data$NewH<-factor(data$NewH)
data$dur <- factor(data$dur)
data$Quadrant <- factor(data$Quadrant)
data$IsPrimed <- factor(data$IsPrimed)
data$rep<- factor(data$rep)
data$Induction <- factor(data$Induction)
data2$block <- factor(data2$block)
data2$hyp <- factor(data2$hyp)
data2$NewH<-factor(data2$NewH, ordered=TRUE)
data2$dur <- factor(data2$dur)
data2$Quadrant <- factor(data2$Quadrant)
data2$IsPrimed <- factor(data2$IsPrimed)
data2$rep<- factor(data2$rep)
data2$HypnoYN<-factor(data2$HypnoYN)
data2$Induction <- factor(data2$Induction)
data2$NewH<-ordered(data2$NewH)
#data2$NewRaw<-ordered(data2$NewRaw)
contrasts(data$Quadrant)=contr.sum(4)
contrasts(data$block)=contr.sum(4)
contrasts(data$hyp)=contr.sum(3)
contrasts(data$NewH)=contr.sum(3)
contrasts(data$dur)=contr.sum(5)
contrasts(data$rep)=contr.sum(2)
contrasts(data$IsPrimed)=contr.sum(3)
contrasts(data$Induction)=contr.sum(2)
contrasts(data2$Quadrant)=contr.sum(4)
contrasts(data2$block)=contr.sum(4)
contrasts(data2$hyp)=contr.sum(3)
contrasts(data2$NewH)=contr.sum(3)
contrasts(data2$dur)=contr.sum(4)
contrasts(data2$rep)=contr.sum(2)
contrasts(data2$IsPrimed)=contr.sum(2)
contrasts(data2$HypnoYN)=contr.sum(2)
contrasts(data2$Induction)=contr.sum(2)
#contrasts(data2$NewRaw)=contr.sum(13)
control=glmerControl(optimizer="bobyqa", optCtrl = list(maxfun = 100000))
CentrTAcc2<-glmer(acc~Induction*IsPrimed+(1|suj), family="binomial", droplevels(data2[data2$block %in% c(1,4)
& data2$NewH %in% c(3),]))
Anova(CentrTAcc2)
